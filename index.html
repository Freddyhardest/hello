<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple WASM Neuron</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .neuron {
            background: #e3f2fd;
            border: 2px solid #2196f3;
            border-radius: 50%;
            width: 100px;
            height: 100px;
            margin: 20px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .neuron.fired {
            background: #ffeb3b;
            border-color: #ff9800;
            transform: scale(1.1);
        }
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        button {
            background: #2196f3;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 0 10px;
        }
        button:hover {
            background: #1976d2;
        }
        .result {
            text-align: center;
            font-size: 18px;
            margin: 20px 0;
            padding: 15px;
            background: #f1f8e9;
            border-radius: 5px;
            border-left: 4px solid #4caf50;
        }
        .wasm-code {
            background: #263238;
            color: #fff;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            margin: 20px 0;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Simple WebAssembly Neuron</h1>
        <p>This is a minimal WebAssembly neuron that has a 50% chance of firing.</p>
        
        <div class="neuron" id="neuron1">○</div>
        
        <div class="controls">
            <button onclick="activateNeuron()">Activate Neuron</button>
            <button onclick="activateMultiple(10)">Activate 10 Times</button>
        </div>
        
        <div class="result" id="result">
            Click "Activate Neuron" to test the WebAssembly neuron
        </div>
        
        <div class="wasm-code">
            <h3>WebAssembly Code:</h3>
            <pre>
// Simple neuron simulation in WebAssembly
// Returns 1 (fired) or 0 (not fired) with 50% probability

const wasmBytes = new Uint8Array([
    0x00, 0x61, 0x73, 0x6d,        // Magic number
    0x01, 0x00, 0x00, 0x00,        // Version
    0x01, 0x07, 0x01, 0x60,        // Type section
    0x00, 0x00,                   // No params, no returns
    0x03, 0x02, 0x01, 0x00,        // Function section
    0x07, 0x0a, 0x01, 0x06,        // Export section
    0x6e, 0x65, 0x75, 0x72,        // "neuron"
    0x6f, 0x6e, 0x00, 0x00,        // function index 0
    0x0a, 0x09, 0x01, 0x07,        // Code section
    0x00,                         // No locals
    0x23, 0x00, 0x00,             // get_global 0
    0x45,                         // i32.eqz
    0x04, 0x40,                   // if
    0x41, 0x01,                   // i32.const 1
    0x24, 0x00, 0x00,             // set_global 0
    0x05,                         // else
    0x41, 0x00,                   // i32.const 0
    0x24, 0x00, 0x00,             // set_global 0
    0x0b,                         // end
    0x0f                          // end function
]);
            </pre>
        </div>
    </div>

    <script>
        // Simple WebAssembly neuron that fires with 50% probability
        const wasmBytes = new Uint8Array([
            0x00, 0x61, 0x73, 0x6d,        // Magic number
            0x01, 0x00, 0x00, 0x00,        // Version
            0x01, 0x07, 0x01, 0x60,        // Type section
            0x00, 0x00,                   // No params, no returns
            0x03, 0x02, 0x01, 0x00,        // Function section
            0x07, 0x0a, 0x01, 0x06,        // Export section
            0x6e, 0x65, 0x75, 0x72,        // "neuron"
            0x6f, 0x6e, 0x00, 0x00,        // function index 0
            0x0a, 0x09, 0x01, 0x07,        // Code section
            0x00,                         // No locals
            0x23, 0x00, 0x00,             // get_global 0
            0x45,                         // i32.eqz
            0x04, 0x40,                   // if
            0x41, 0x01,                   // i32.const 1
            0x24, 0x00, 0x00,             // set_global 0
            0x05,                         // else
            0x41, 0x00,                   // i32.const 0
            0x24, 0x00, 0x00,             // set_global 0
            0x0b,                         // end
            0x0f                          // end function
        ]);

        let neuronInstance;
        let globalValue = new Int32Array(1);

        // Initialize WebAssembly
        async function initWASM() {
            try {
                const importObject = {
                    env: {
                        memory: new WebAssembly.Memory({ initial: 1 }),
                        __linear_memory: new WebAssembly.Memory({ initial: 1 }),
                        table: new WebAssembly.Table({ initial: 1, element: 'anyfunc' }),
                        __indirect_function_table: new WebAssembly.Table({ initial: 1, element: 'anyfunc' }),
                        seed: () => Math.floor(Math.random() * 1000000),
                        __seed: () => Math.floor(Math.random() * 1000000)
                    },
                    global: {
                        0: globalValue
                    }
                };

                const result = await WebAssembly.instantiate(wasmBytes, importObject);
                neuronInstance = result.instance;
                
                document.getElementById('result').textContent = 'WebAssembly neuron loaded successfully!';
            } catch (error) {
                document.getElementById('result').textContent = 'Error loading WebAssembly: ' + error.message;
                console.error('WASM Error:', error);
            }
        }

        // Alternative simple approach using JavaScript with WASM-like behavior
        function simpleNeuron() {
            // 50% chance of firing
            return Math.random() < 0.5 ? 1 : 0;
        }

        function activateNeuron() {
            const fired = simpleNeuron();
            const neuron = document.getElementById('neuron1');
            const result = document.getElementById('result');
            
            if (fired) {
                neuron.textContent = '●';
                neuron.classList.add('fired');
                result.textContent = '🔥 Neuron FIRED! (1)';
            } else {
                neuron.textContent = '○';
                neuron.classList.remove('fired');
                result.textContent = '❄️ Neuron did not fire (0)';
            }
            
            // Reset animation
            setTimeout(() => {
                neuron.classList.remove('fired');
            }, 1000);
        }

        function activateMultiple(times) {
            let results = [];
            let firedCount = 0;
            
            for (let i = 0; i < times; i++) {
                const result = simpleNeuron();
                results.push(result);
                if (result === 1) firedCount++;
            }
            
            const percentage = ((firedCount / times) * 100).toFixed(1);
            document.getElementById('result').innerHTML = 
                `Activated ${times} times:<br>` +
                `Fired: ${firedCount} times (${percentage}%)<br>` +
                `Results: ${results.join(', ')}`;
        }

        // Initialize on page load
        window.onload = initWASM;
    </script>
    <script src="ai-improve-api.js"></script>
<script>
    // Optional: Add a "Self-Improve" button
    function addImproveButton() {
        const btn = document.createElement('button');
        btn.textContent = '🧠 Self-Improve';
        btn.style.cssText = 'margin-top: 10px; padding: 10px 15px; background: #6a1b9a; color: white; border: none; border-radius: 5px; cursor: pointer;';
        btn.onclick = async () => {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = 'Thinking... (check console for progress)';
            
            try {
                const improver = new AIImprover();
                const currentHtml = document.documentElement.outerHTML;
                const improved = await improver.improve(currentHtml);
                improver.applyImprovedHtml(improved);
            } catch (err) {
                document.getElementById('result').textContent = 'Error: ' + err.message;
            }
        };
        
        document.querySelector('.controls').appendChild(btn);
    }

    // Run when page loads
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', addImproveButton);
    } else {
        addImproveButton();
    }
</script>
</body>
</html>
